<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudyLocus | Customizable Dashboard for JEE & NEET Prep</title>
    <meta name="description" content="A customizable dashboard for students preparing for JEE, NEET, and other competitive exams. Track your progress with a journey graph, manage tasks with to-do lists, and stay focused with a Pomodoro timer.">
    <meta name="keywords" content="JEE dashboard, NEET dashboard, study planner, exam preparation, Pomodoro timer, syllabus tracker, mock test analysis, student dashboard, JEE 2026, NEET 2026, study logger">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sval.tech/studylocus/">
    <meta property="og:title" content="StudyLocus | Customizable Dashboard for JEE & NEET Prep">
    <meta property="og:description" content="A customizable dashboard for students preparing for JEE, NEET, and other competitive exams. Track your progress, manage tasks, and stay focused.">
    <meta property="og:image" content="https://i.ibb.co/5Wm282XC/logo1.png">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://sval.tech/studylocus/">
    <meta property="twitter:title" content="StudyLocus | Customizable Dashboard for JEE & NEET Prep">
    <meta property="twitter:description" content="A customizable dashboard for students preparing for JEE, NEET, and other competitive exams. Track your progress, manage tasks, and stay focused.">
    <meta property="twitter:image" content="https://i.ibb.co/5Wm282XC/logo1.png">
    
    <link rel="canonical" href="https://sval.tech/studylocus/" />
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue&family=Fira+Code&family=Inter:wght@400;600;700&family=Roboto+Slab&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <style>
		:root,[data-theme=alakh-pandey],[data-theme=dracula],[data-theme=forest],[data-theme=ocean],[data-theme=rose-gold],[data-theme=sunset]{--card-shadow:0 4px 12px rgba(0,0,0,0.3)}.day,.tab-btn{cursor:pointer}#bg-overlay,.aspect-w-16>*,.modal-overlay{right:0;bottom:0;top:0}#customize-modal.modal-overlay,#info-modal.modal-overlay{align-items:flex-start;padding-top:2rem;padding-bottom:2rem;overflow-y:auto}#customize-modal.modal-overlay>.card,#info-modal.modal-overlay>.card{flex-shrink:0}.tab-nav{display:flex;border-bottom:1px solid var(--border-color);margin-bottom:1.5rem}.tab-btn{padding:.75rem .5rem;border:none;background-color:transparent;color:var(--text-secondary);font-size:.9rem;font-weight:600;border-bottom:3px solid transparent;transition:.2s;flex:1;word-break:break-word;line-height:1.3;text-align:center}.card,.form-input,.tab-btn:hover,body,select.form-input option{color:var(--text-primary)}.day .tooltip,.modal-overlay{transition:opacity .3s;pointer-events:none}.tab-btn.active{color:var(--accent-color);border-bottom-color:var(--accent-color)}.tab-content{animation:.3s ease-in-out fadeIn}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}:root{--bg-color:#0d1117;--card-bg-color:rgba(22, 27, 34, 0.85);--border-color:#30363d;--text-primary:#c9d1d9;--text-secondary:#8b949e;--accent-color:#58a6ff;--accent-glow:0 0 15px rgba(88, 166, 255, 0.3);--font-family:'Inter',sans-serif;--day-past-color:#21262d;--day-future-color:#0e4429;--day-today-color:#1a633a;--day-exam-color:#9e2a2b;--day-part-test-color:#1f6feb}[data-theme=light]{--bg-color:#f0f0f0;--card-bg-color:rgba(255, 255, 255, 0.8);--border-color:#d1d5db;--text-primary:#1f2937;--text-secondary:#4b5563;--accent-color:#3b82f6;--accent-glow:0 0 15px rgba(59, 130, 246, 0.4);--card-shadow:0 4px 12px rgba(0,0,0,0.1);--day-past-color:#ebedf0;--day-future-color:#9be9a8;--day-today-color:#40c463;--day-exam-color:#da5252;--day-part-test-color:#58a6ff}[data-theme=cyberpunk]{--bg-color:#0c0a24;--card-bg-color:rgba(23, 0, 61, 0.7);--border-color:#ff00f2;--text-primary:#00f7ff;--text-secondary:#faff00;--accent-color:#ff00f2;--accent-glow:0 0 20px rgba(255, 0, 242, 0.5);--card-shadow:0 0 10px rgba(255, 0, 242, 0.3);--day-past-color:#180f3d;--day-future-color:#5d00ff;--day-today-color:#00f7ff;--day-exam-color:#ff00f2;--day-part-test-color:#faff00}[data-theme=forest]{--bg-color:#1a201a;--card-bg-color:rgba(32, 42, 32, 0.75);--border-color:#4a5c4a;--text-primary:#d4e0d4;--text-secondary:#8a9c8a;--accent-color:#6a9c6a;--accent-glow:0 0 15px rgba(106, 156, 106, 0.4);--day-past-color:#2f3e2f;--day-future-color:#4a5c4a;--day-today-color:#9ae6b4;--day-exam-color:#c53030;--day-part-test-color:#63b3ed}[data-theme=rose-gold]{--bg-color:#4a1c2b;--card-bg-color:rgba(107, 48, 64, 0.75);--border-color:#b97a8d;--text-primary:#f5e5e8;--text-secondary:#d4b2bb;--accent-color:#f5c6d3;--accent-glow:0 0 15px rgba(245, 198, 211, 0.4);--day-past-color:#6b3040;--day-future-color:#b97a8d;--day-today-color:#f5e5e8;--day-exam-color:#ff6d6d;--day-part-test-color:#f5c6d3}[data-theme=ocean]{--bg-color:#0d1b2a;--card-bg-color:rgba(27, 38, 59, 0.75);--border-color:#415a77;--text-primary:#e0e1dd;--text-secondary:#778da9;--accent-color:#61a5c2;--accent-glow:0 0 15px rgba(97, 165, 194, 0.4);--day-past-color:#1b263b;--day-future-color:#415a77;--day-today-color:#e0e1dd;--day-exam-color:#ff6b6b;--day-part-test-color:#61a5c2}[data-theme=sunset]{--bg-color:#2c0e37;--card-bg-color:rgba(74, 29, 89, 0.75);--border-color:#83387a;--text-primary:#f8f3f9;--text-secondary:#e4a1d4;--accent-color:#ff6d6d;--accent-glow:0 0 15px rgba(255, 109, 109, 0.4);--day-past-color:#4a1d59;--day-future-color:#83387a;--day-today-color:#f8f3f9;--day-exam-color:#e4a1d4;--day-part-test-color:#ff6d6d}[data-theme=dracula]{--bg-color:#282a36;--card-bg-color:rgba(68, 71, 90, 0.8);--border-color:#6272a4;--text-primary:#f8f8f2;--text-secondary:#bd93f9;--accent-color:#ff79c6;--accent-glow:0 0 15px rgba(255, 121, 198, 0.4);--day-past-color:#44475a;--day-future-color:#6272a4;--day-today-color:#50fa7b;--day-exam-color:#ff5555;--day-part-test-color:#bd93f9}[data-theme=alakh-pandey]{--bg-color:#1e1e1e;--card-bg-color:rgba(40, 40, 40, 0.85);--border-color:#f5cb5c;--text-primary:#ffffff;--text-secondary:#e0e0e0;--accent-color:#f5cb5c;--accent-glow:0 0 15px rgba(245, 203, 92, 0.4);--day-past-color:#333533;--day-future-color:#4f4f4f;--day-today-color:#f5cb5c;--day-exam-color:#cf6679;--day-part-test-color:#bb86fc}[data-theme=chaitanya-noob]{--bg-color:#000000;--card-bg-color:transparent;--border-color:#39ff14;--text-primary:#39ff14;--text-secondary:#ff00ff;--accent-color:#39ff14;--accent-glow:0 0 20px rgba(57, 255, 20, 0.5);--card-shadow:0 0 10px rgba(57, 255, 20, 0.3);--day-past-color:transparent;--day-future-color:transparent;--day-today-color:transparent;--day-exam-color:transparent;--day-part-test-color:transparent}[data-theme=god-mode]{--bg-color:#000000;--card-bg-color:rgba(10, 20, 10, 0.7);--border-color:#00ff00;--text-primary:#00ff00;--text-secondary:#008000;--accent-color:#00ff00;--font-family:'Fira Code',monospace;--day-past-color:#002000;--day-future-color:#004000;--day-today-color:#00ff00;--day-exam-color:#ff0000;--day-part-test-color:#00ffff}[data-theme=chaitanya-noob] .card{backdrop-filter:none;-webkit-backdrop-filter:none}[data-theme=chaitanya-noob] .graph-container .day{border:none!important}[data-theme=chaitanya-noob] .graph-container .day::before{content:'🤓';font-size:12px;line-height:14px;display:block;text-align:center}[data-theme=chaitanya-noob] .graph-container .day-today{border:1px solid var(--accent-color)!important}body{font-family:var(--font-family);background-color:var(--bg-color);background-size:cover;background-position:center;background-attachment:fixed;text-shadow:0 1px 2px rgba(0,0,0,.5);transition:background-color .5s,background-image .5s}#bg-overlay{position:fixed;left:0;background-color:rgba(0,0,0,.5);z-index:-1}.graph-container{display:grid;grid-template-columns:repeat(auto-fill,minmax(14px,1fr));grid-auto-rows:14px;grid-gap:3px;overflow-x:auto}.day{width:14px;height:14px;border-radius:3px;position:relative}.day-past{background-color:var(--day-past-color)}.day-future{background-color:var(--day-future-color)}.day-today{background-color:var(--day-today-color);border:1px solid var(--accent-color)}.day-exam{background-color:var(--day-exam-color)}.day-part-test{background-color:var(--day-part-test-color)}.day .tooltip{visibility:hidden;width:180px;background-color:#21262d;color:#fff;text-align:center;border-radius:6px;padding:5px 0;position:absolute;z-index:10;bottom:125%;left:50%;margin-left:-90px;opacity:0;font-size:12px;border:1px solid #30363d}.day:hover .tooltip{visibility:visible;opacity:1}#countdown-timer{font-size:1.75rem;font-weight:600}@media (min-width:640px){#countdown-timer{font-size:2.25rem}}@media (min-width:1024px){#countdown-timer{font-size:2.5rem}}.card{background-color:var(--card-bg-color);border:1px solid var(--border-color);border-radius:12px;padding:1.25rem;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);box-shadow:var(--card-shadow)}.card-header{display:flex;justify-content:space-between;align-items:center;padding:0;margin-bottom:.75rem}.card-header h2{margin-left:.25rem}.card-header-controls{display:flex;align-items:center;gap:.25rem}.card-header-controls button{color:var(--text-secondary);padding:.25rem;border-radius:9999px;transition:color .2s,background-color .2s}.card-header-controls button:hover{color:var(--text-primary);background-color:rgba(255,255,255,.1)}.drag-handle{cursor:grab;padding:.5rem}.sortable-ghost{background:#1f2937;opacity:.6;border:2px dashed var(--accent-color)}.sortable-chosen{cursor:grabbing}.modal-overlay{position:fixed;left:0;background-color:rgba(0,0,0,.5);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:50;opacity:0}.modal-overlay:not(.hidden){opacity:1;pointer-events:auto}.modal-overlay>.card{transform:scale(.95);opacity:0;transition:transform .3s,opacity .3s}.modal-overlay:not(.hidden)>.card{transform:scale(1);opacity:1}.todo-item.completed span{text-decoration:line-through;color:var(--text-secondary)}.form-input{background-color:rgba(0,0,0,.2);border:1px solid var(--border-color);transition:border-color .2s,box-shadow .2s}.form-input:focus{outline:0;border-color:var(--accent-color);box-shadow:0 0 0 2px color-mix(in srgb,var(--accent-color) 40%,transparent)}.btn-primary{background-color:var(--accent-color);color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.2);border:1px solid transparent;transition:.2s ease-in-out}.btn-primary:hover{transform:translateY(-2px);box-shadow:0 4px 10px rgba(0,0,0,.3),var(--accent-glow)}header .space-x-2>button{transition:transform .2s,box-shadow .2s,background-color .2s}header .space-x-2>button:hover{transform:translateY(-2px);box-shadow:var(--accent-glow)}[data-theme=alakh-pandey] .btn-primary,[data-theme=chaitanya-noob] .btn-primary,[data-theme=cyberpunk] .btn-primary,[data-theme=dracula] .btn-primary,[data-theme=ocean] .btn-primary,[data-theme=rose-gold] .btn-primary,[data-theme=sunset] .btn-primary{color:var(--bg-color)}.text-secondary{color:var(--text-secondary)}select.form-input{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem}select.form-input option{background:var(--card-bg-color)}[data-theme=light] .form-input{background-color:#e5e7eb;border-color:#9ca3af}.pomodoro-btn.active,.todo-checkbox:checked,.youtube-container::after{background-color:var(--accent-color)}.no-scrollbar{-ms-overflow-style:none;scrollbar-width:none}.no-scrollbar::-webkit-scrollbar{display:none}.delete-card-btn:hover{color:#ef4444!important}.pomodoro-btn.active,[data-theme=light] .pomodoro-btn.active{color:#fff}.aspect-w-16{position:relative;padding-bottom:56.25%}.aspect-w-16>*{position:absolute;height:100%;width:100%;left:0}.fab-container{position:fixed;bottom:1.5rem;right:1.5rem;z-index:40}.fab-menu{visibility:hidden;opacity:0;transform:translateY(10px);transition:.2s ease-out;position:absolute;bottom:100%;right:0;margin-bottom:.5rem}.fab-container:hover .fab-menu{visibility:visible;opacity:1;transform:translateY(0)}.todo-checkbox{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:1.25rem;height:1.25rem;border-radius:.25rem;border:1px solid var(--border-color);background-color:transparent;cursor:pointer;position:relative;transition:background-color .2s ease-in-out,border-color .2s ease-in-out}.todo-checkbox:checked{border-color:var(--accent-color)}.todo-checkbox:checked::after{content:'✔';position:absolute;color:#fff;top:50%;left:50%;transform:translate(-50%,-50%);font-size:.8rem}[data-theme=light] .todo-checkbox:checked::after{color:var(--card-bg-color)}body.zen-mode .card-header-controls,body.zen-mode .delete-mark-item,body.zen-mode .delete-test-btn,body.zen-mode .delete-todo-item,body.zen-mode .fab-container,body.zen-mode .log-btn,body.zen-mode .pomodoro-btn,body.zen-mode .pomodoro-settings,body.zen-mode .reset-btn,body.zen-mode footer,body.zen-mode form,body.zen-mode header{display:none}body.zen-mode .card:hover{transform:none;box-shadow:var(--card-shadow)}body.zen-mode .card-header{justify-content:center}.youtube-container{position:relative;border-radius:.375rem;overflow:hidden}.youtube-container::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;opacity:.2;mix-blend-mode:screen;pointer-events:none;transition:background-color .5s,opacity .5s;z-index:1}.youtube-container.tint-disabled::after{opacity:0}.youtube-iframe{transition:filter .3s ease-in-out}.youtube-container.blurred .youtube-iframe{filter:blur(16px)}.form-input-toggle{-webkit-appearance:none;appearance:none;position:relative;width:38px;height:22px;border-radius:9999px;background-color:rgba(255,255,255,.2);border:1px solid var(--border-color);transition:background-color .2s ease-in-out;cursor:pointer}.form-input-toggle::before{content:"";position:absolute;top:2px;left:2px;width:16px;height:16px;border-radius:50%;background-color:#fff;transition:transform .2s ease-in-out}.form-input-toggle:checked{background-color:var(--accent-color)}.form-input-toggle:checked::before{transform:translateX(16px)}.legend-item{display:flex;align-items:center;gap:.5rem}.legend-color{width:12px;height:12px;border-radius:2px}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border-width:0}@keyframes fall-apart{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}#sync-status{transition:opacity .5s}
        /* ✨ END: Firebase Auth UI Styles */
    </style>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "StudyLocus Dashboard",
      "applicationCategory": "EducationalApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0"
      },
      "author": {
        "@type": "Person",
        "name": "Shaurya Pratap Singh",
        "url": "https://github.com/svalordev"
      },
      "description": "A customizable dashboard for students preparing for JEE, NEET, and other competitive exams. Track your progress with a journey graph, manage tasks with to-do lists, and stay focused with a Pomodoro timer."
    }
    </script>
</head>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-TCK0S6VC58"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-TCK0S6VC58');
</script>
<body class="antialiased">
    <div id="bg-overlay"></div>
    <div class="container mx-auto px-2 sm:px-4 py-6">
        <header class="flex justify-between items-center mb-6">
            <h1 id="main-title" class="text-3xl sm:text-4xl font-bold cursor-pointer">JEE 2026</h1>
            
            <div class="flex items-center gap-2 sm:gap-4">
                <div class="flex items-center gap-2">
                    <span id="sync-status" class="text-xs text-secondary opacity-0"></span>
                    <div id="auth-container"></div>
                </div>
                <div class="flex items-center space-x-2">
                    <button id="info-btn" class="bg-gray-700/50 hover:bg-gray-600/60 text-white font-bold p-2 rounded-full transition-colors text-sm" title="About this project" aria-label="About this project">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>
                    </button>
                    <button id="customize-btn" class="bg-gray-700/50 hover:bg-gray-600/60 text-white font-bold rounded-full w-10 h-10 md:w-auto md:rounded-md flex items-center justify-center md:px-4 md:py-2 transition-all text-sm" title="Customize Dashboard" aria-label="Customize Dashboard">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="4" y1="21" y2="14"></line><line x1="4" x2="4" y1="10" y2="3"></line><line x1="12" x2="12" y1="21" y2="12"></line><line x1="12" x2="12" y1="8" y2="3"></line><line x1="20" x2="20" y1="21" y2="16"></line><line x1="20" x2="20" y1="12" y2="3"></line><line x1="1" x2="7" y1="14" y2="14"></line><line x1="9" x2="15" y1="8" y2="8"></line><line x1="17" x2="23" y1="16" y2="16"></line></svg>
                        <span class="hidden md:inline md:ml-2">Customize</span>
                    </button>
                    <button id="add-card-btn" class="btn-primary font-bold rounded-full w-10 h-10 md:w-auto md:rounded-md flex items-center justify-center md:px-4 md:py-2 transition-all text-sm" title="Add New Card" aria-label="Add New Card">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        <span class="hidden md:inline md:ml-2">Add Card</span>
                    </button>
                    <button id="zen-mode-btn" class="bg-gray-700/50 hover:bg-gray-600/60 text-white font-bold p-2 rounded-full transition-colors text-sm" title="Enter Zen Mode" aria-label="Enter Zen Mode">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2Z"></path><path d="m9.5 16.5 4-4"></path><path d="m14.5 16.5-4-4"></path><path d="M12 8V7"></path></svg>
                    </button>
                </div>
            </div>
        </header>

        <main id="dashboard-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4">
            </main>
    </div>

    <button id="exit-zen-btn" class="hidden fixed top-4 right-4 bg-gray-800/50 hover:bg-gray-700/70 backdrop-blur-sm text-white font-bold p-2 rounded-full transition-colors z-50" title="Exit Zen Mode" aria-label="Exit Zen Mode"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></button>

    <footer class="text-center py-4 mt-4">
        <p class="text-xs text-secondary">
            Built by <a href="https://github.com/svalordev" target="_blank" rel="noopener noreferrer" class="hover:underline" style="color: var(--accent-color);">Shaurya Pratap Singh</a> | ©️ Shaurya Pratap Singh 2025 | <a href="https://sval.tech/studylocus/termsandconditions.html" rel="noopener noreferrer" class="hover:underline" style="color: var(--accent-color);">Terms and Conditions</a> | <a href="https://t.me/studylocus" target="_blank" rel="noopener noreferrer" class="hover:underline" style="color: var(--accent-color);">Telegram</a>
        </p>
    </footer>

    <template id="countdown-template">
        <div class="card" data-card-id="countdown">
            <div class="card-header">
                <h2 class="text-lg font-semibold">Countdown</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div id="countdown-timer" class="flex justify-center space-x-2 sm:space-x-4 md:space-x-8 text-center py-2">
                <div><div data-value="days" class="font-bold">00</div><div class="text-xs sm:text-sm text-secondary">Days</div></div>
                <div><div data-value="hours" class="font-bold">00</div><div class="text-xs sm:text-sm text-secondary">Hours</div></div>
                <div><div data-value="minutes" class="font-bold">00</div><div class="text-xs sm:text-sm text-secondary">Minutes</div></div>
                <div><div data-value="seconds" class="font-bold">00</div><div class="text-xs sm:text-sm text-secondary">Seconds</div></div>
            </div>
        </div>
    </template>

    <template id="time-template">
        <div class="card" data-card-id="time">
            <div class="card-header">
                <h2 class="text-lg font-semibold">Current Time</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div class="text-center py-2">
                <div data-value="time" class="text-3xl font-bold tracking-wider">00:00:00 AM</div>
                <div data-value="date" class="text-sm text-secondary">Sunday, August 17, 2025</div>
            </div>
        </div>
    </template>

    <template id="graph-template">
        <div class="card" data-card-id="graph">
            <div class="card-header">
                <h2 class="text-lg font-semibold">Journey</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div class="graph-container no-scrollbar" id="contribution-graph"></div>
            <div class="flex justify-center flex-wrap gap-x-4 gap-y-2 mt-4 text-xs text-secondary">
                <div class="legend-item"><div class="legend-color day-future"></div><span>Future</span></div>
                <div class="legend-item"><div class="legend-color day-today"></div><span>Today</span></div>
                <div class="legend-item"><div class="legend-color day-part-test"></div><span>Test</span></div>
                <div class="legend-item"><div class="legend-color day-exam"></div><span>Exam</span></div>
            </div>
        </div>
    </template>

    <template id="tests-template">
         <div class="card" data-card-id="tests">
             <div class="card-header">
                 <h2 class="text-lg font-semibold">Test Planner</h2>
                 <div class="card-header-controls">
                     <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                     <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                 </div>
             </div>
             <form id="add-test-form" class="flex flex-col gap-3 mb-4">
                 <input type="date" name="date" class="form-input rounded-md p-2 w-full text-sm" required>
                 <input type="text" name="name" placeholder="Test Name" class="form-input rounded-md p-2 flex-grow text-sm" required>
                 <button type="submit" class="btn-primary font-bold py-2 px-4 rounded-md transition-colors w-full text-sm">Add Test</button>
             </form>
             <div id="test-list-container">
                 <h3 class="text-md font-semibold mb-2 border-b pb-1" style="border-color: var(--border-color);">Tests</h3>
                 <ul id="test-list" class="space-y-2 max-h-48 overflow-y-auto no-scrollbar"></ul>
             </div>
         </div>
    </template>
    
    <template id="quote-template">
        <div class="card" data-card-id="quote">
            <div class="card-header">
                <h2 class="text-lg font-semibold">Quote</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div id="quote-card-content" class="text-center cursor-pointer transition-transform transform hover:scale-105">
                 <p id="quote" class="text-md italic">"The best way to predict the future is to create it."</p>
                 <p id="author" class="text-sm text-secondary mt-2">- Peter Drucker</p>
            </div>
        </div>
    </template>

    <template id="note-card-template">
        <div class="card custom-card" data-card-type="note">
            <div class="card-header">
                <h2 class="text-lg font-semibold card-title">Note</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <button class="delete-card-btn" title="Delete card" aria-label="Delete card"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div class="text-sm card-content whitespace-pre-wrap"></div>
        </div>
    </template>

    <template id="todo-card-template">
        <div class="card custom-card" data-card-type="todo">
            <div class="card-header">
                <h2 class="text-lg font-semibold card-title">To-Do List</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <button class="delete-card-btn" title="Delete card" aria-label="Delete card"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div class="card-content">
                <div class="progress-container w-full bg-gray-700 rounded-full h-2.5 mb-4">
                    <div class="progress-bar bg-green-500 h-2.5 rounded-full" style="width: 0%"></div>
                </div>
                <ul class="todo-list space-y-1 max-h-48 overflow-y-auto mb-3 no-scrollbar"></ul>
                <form class="add-todo-form flex gap-2 mt-2">
                    <input type="text" placeholder="Add a new task..." class="form-input rounded-md p-2 w-full text-sm" required>
                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-3 rounded-md text-sm" aria-label="Add task">+</button>
                </form>
            </div>
        </div>
    </template>

    <template id="line-graph-card-template">
	    <div class="card custom-card" data-card-type="line-graph">
			
	        <div class="card-header">
	            <h2 class="text-lg font-semibold card-title">Graph</h2>
	            <div class="card-header-controls">
	                <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <button class="delete-card-btn" title="Delete card" aria-label="Delete card"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
	            </div>
	        </div>
	        <div class="card-content">
	            <div class="mb-2 h-64 relative">
	                <canvas class="marks-chart"></canvas>
	            </div>
	            
	            <!-- ▼▼▼ ADD THIS NEW DIV FOR TOGGLE BUTTONS ▼▼▼ -->
	            <div class="chart-toggles flex justify-center gap-2 mb-4">
	                <button data-subject="total" class="text-sm px-3 py-1 rounded-md border active" style="border-color: var(--accent-color); background-color: var(--accent-color); color: white;">Total</button>
	                <button data-subject="physics" class="text-sm px-3 py-1 rounded-md border border-gray-600">Physics</button>
	                <button data-subject="chemistry" class="text-sm px-3 py-1 rounded-md border border-gray-600">Chemistry</button>
	                <button data-subject="maths" class="text-sm px-3 py-1 rounded-md border border-gray-600">Maths/Bio</button>
	            </div>
	            <!-- ▲▲▲ END OF NEW DIV ▲▲▲ -->
	
	            <!-- ▼▼▼ REPLACE THE OLD FORM WITH THIS NEW ONE ▼▼▼ -->
	            <form class="add-marks-form grid grid-cols-2 gap-2 mb-3">
	                <input type="text" name="name" placeholder="Paper Name" class="form-input rounded-md p-2 text-sm col-span-2" required>
	                <input type="number" name="phy" placeholder="Phy" class="form-input rounded-md p-2 text-sm w-full" required>
	                <input type="number" name="chem" placeholder="Chem" class="form-input rounded-md p-2 text-sm w-full" required>
	                <input type="number" name="math" placeholder="Math/Bio" class="form-input rounded-md p-2 text-sm w-full" required>
	                <input type="number"name="maxMarks" placeholder="MAXIMUM MARKS OF PAPER" class="form-input rounded-md p-2 text-sm w-full" required>
	                <button type="submit" class="btn-primary font-bold py-2 px-3 rounded-md text-sm col-span-2" aria-label="Add mark entry">Add Entry</button>
	            </form>
	            <!-- ▲▲▲ END OF NEW FORM ▲▲▲ -->
	            
	            <ul class="marks-list space-y-1 max-h-24 overflow-y-auto no-scrollbar"></ul>
	        </div>
	    </div>
	</template>
    
    <template id="pomodoro-card-template">
        <div class="card custom-card" data-card-type="pomodoro">
            <div class="card-header">
                <h2 class="text-lg font-semibold card-title">Pomodoro</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <button class="delete-card-btn" title="Delete card" aria-label="Delete card"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div class="card-content text-center">
                <div class="flex justify-center gap-2 mb-4">
                    <button data-mode="pomodoro" class="pomodoro-btn text-sm px-3 py-1 rounded-md border border-transparent hover:border-gray-500">Pomodoro</button>
                    <button data-mode="shortBreak" class="pomodoro-btn text-sm px-3 py-1 rounded-md border border-transparent hover:border-gray-500">Short Break</button>
                    <button data-mode="longBreak" class="pomodoro-btn text-sm px-3 py-1 rounded-md border border-transparent hover:border-gray-500">Long Break</button>
                </div>
                <div class="timer-display text-6xl font-bold my-4">25:00</div>
                <div class="flex justify-center gap-4">
                    <button class="start-pause-btn btn-primary font-bold py-2 px-8 text-lg rounded-md">START</button>
                    <button class="reset-btn text-secondary hover:text-primary">Reset</button>
                </div>
                 <div class="focus-status text-xs text-yellow-400 mt-2 h-4"></div>
                <div class="pomodoro-settings mt-4 flex justify-center gap-4 items-center">
                    <label class="flex flex-col text-xs items-center">
                        Work
                        <input type="number" data-mode="pomodoro" class="pomodoro-duration-input form-input w-16 text-center rounded-md p-1" min="1">
                    </label>
                    <label class="flex flex-col text-xs items-center">
                        Short
                        <input type="number" data-mode="shortBreak" class="pomodoro-duration-input form-input w-16 text-center rounded-md p-1" min="1">
                    </label>
                    <label class="flex flex-col text-xs items-center">
                        Long
                        <input type="number" data-mode="longBreak" class="pomodoro-duration-input form-input w-16 text-center rounded-md p-1" min="1">
                    </label>
                </div>
            </div>
        </div>
    </template>

    <template id="youtube-card-template">
        <div class="card custom-card" data-card-type="youtube">
            <div class="card-header">
                <h2 class="text-lg font-semibold card-title">YouTube</h2>
                <div class="card-header-controls">
                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <button class="delete-card-btn" title="Delete card" aria-label="Delete card"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div class="card-content">
                <div class="aspect-w-16 mb-3 youtube-container">
                    <iframe class="youtube-iframe w-full h-full" title="Embedded YouTube video player" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <form class="update-youtube-form flex gap-2">
                    <label for="youtube-url-input" class="sr-only">YouTube URL</label>
                    <input type="text" id="youtube-url-input" name="url" placeholder="Paste YouTube URL..." class="form-input rounded-md p-2 w-full text-sm" required>
                    <button type="submit" class="btn-primary font-bold py-2 px-3 rounded-md text-sm">Load</button>
                </form>
            </div>
        </div>
    </template>

    <template id="time-logger-card-template">
        <div class="card custom-card" data-card-type="time-logger">
            <div class="card-header">
                <h2 class="text-lg font-semibold card-title">Study Logger</h2>
                <div class="card-header-controls">
					<button class="pip-btn" title="Show in floating window" aria-label="Show in floating window">
			            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.75 4.75h-8.5a2 2 0 0 0-2 2v8.5a2 2 0 0 0 2 2h8.5a2 2 0 0 0 2-2v-8.5a2 2 0 0 0-2-2Z"/><path d="M19.25 8.75h-8.5a2 2 0 0 1-2-2v-2.5"/><path d="M17.5 15.5V14"/><path d="m15 12 5 5"/></svg>
			        </button>

                    <button class="toggle-colspan-btn" title="Toggle size" aria-label="Toggle card size"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 21l-6-6m6 6v-4m0 4h-4"/><path d="M3 3l6 6"/><path d="M3 3v4m0-4h4"/></svg></button>
                    <button class="delete-card-btn" title="Delete card" aria-label="Delete card"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg></button>
                    <span class="drag-handle" aria-label="Drag to reorder"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="9" cy="12" r="1"/><circle cx="9" cy="5" r="1"/><circle cx="9" cy="19" r="1"/><circle cx="15" cy="12" r="1"/><circle cx="15" cy="5" r="1"/><circle cx="15" cy="19" r="1"/></svg></span>
                </div>
            </div>
            <div class="card-content text-center">
                <div class="timer-display text-5xl font-bold my-4 tabular-nums">00:00:00</div>
                 <div class="focus-status text-xs text-yellow-400 mb-2 h-4"></div>
                <div class="flex flex-col sm:flex-row gap-2 mb-4 items-center justify-center">
                    <label for="subject-select" class="text-sm text-secondary sr-only sm:not-sr-only">Subject:</label>
                    <select id="subject-select" class="subject-select form-input rounded-md p-2 text-sm flex-grow">
                        </select>
                </div>
                <div class="flex justify-center gap-4">
                    <button class="start-pause-btn btn-primary font-bold py-2 px-8 text-lg rounded-md">START</button>
                    <button class="log-btn bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-md">LOG</button>
                    <button class="reset-btn text-secondary hover:text-primary">Reset</button>
                </div>
                <p class="log-message text-red-500 text-xs mt-2 h-4"></p>
                <div class="w-full border-t border-[var(--border-color)] my-3"></div>
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-md font-semibold text-left">Today's Log</h3>
                    <span class="total-study-time text-sm font-bold text-secondary"></span>
                </div>
                <ul class="study-log-list space-y-2 max-h-32 overflow-y-auto no-scrollbar text-left text-sm">
                    </ul>
            </div>
        </div>
    </template>

    <div id="add-card-modal" class="modal-overlay hidden">
        <div class="card w-11/12 max-w-md">
            <h2 class="text-xl font-semibold mb-4">Add New Card</h2>
            <form id="new-card-form">
                <label for="new-card-type" class="sr-only">Card Type</label>
                <select id="new-card-type" class="form-input rounded-md p-2 w-full mb-3">
                    <option value="note">Note</option>
                    <option value="todo">To-Do List</option>
                    <option value="line-graph">Line Graph</option>
                    <option value="pomodoro">Pomodoro Timer</option>
                    <option value="youtube">YouTube Video</option>
                    <option value="time-logger">Study Logger</option>
                </select>
                 <label for="new-card-title" class="sr-only">Card Title</label>
                <input type="text" id="new-card-title" placeholder="Card Title" class="form-input rounded-md p-2 w-full mb-3" required>
                 <label for="new-card-content" class="sr-only">Card Content</label>
                <textarea id="new-card-content" placeholder="Card Content (URL for YouTube)" rows="4" class="form-input rounded-md p-2 w-full mb-4"></textarea>
                <div class="flex justify-end gap-3">
                    <button type="button" id="cancel-add-card" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-md">Cancel</button>
                    <button type="submit" class="btn-primary font-bold py-2 px-4 rounded-md">Add</button>
                </div>
            </form>
        </div>
    </div>

    <div id="customize-modal" class="modal-overlay hidden">
        <div class="card w-11/12 max-w-md relative">
             <button id="close-customize-icon-btn" class="absolute top-3 right-3 text-secondary hover:text-primary transition-colors p-1 rounded-full" aria-label="Close customize panel">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
             </button>
            <h2 class="text-xl font-semibold mb-4">Customize Dashboard</h2>
            <div class="space-y-4">
                 <div>
                     <label for="exam-type-select" class="block text-sm font-medium text-secondary mb-1">Target Exam</label>
                     <div class="grid grid-cols-2 gap-2">
                         <select id="exam-type-select" class="form-input rounded-md p-2 w-full">
                             <option value="JEE">JEE</option>
                             <option value="NEET">NEET</option>
                         </select>
                         <label for="exam-year-select" class="sr-only">Exam Year</label>
                         <select id="exam-year-select" class="form-input rounded-md p-2 w-full">
                             <option value="2026">2026</option>
                             <option value="2027">2027</option>
                         </select>
                     </div>
                 </div>
                 <div>
                     <label for="theme-select" class="block text-sm font-medium text-secondary mb-1">Theme</label>
                     <select id="theme-select" class="form-input rounded-md p-2 w-full">
                         <option value="default">Deep Space</option>
                         <option value="light">Solarized Light</option>
                         <option value="cyberpunk">Cyberpunk</option>
                         <option value="forest">Forest</option>
                         <option value="rose-gold">Rose Gold</option>
                         <option value="ocean">Ocean</option>
                         <option value="sunset">Sunset</option>
                         <option value="dracula">Dracula</option>
                         <option value="alakh-pandey" class="hidden">Alakh Pandey</option>
                     </select>
                 </div>
                 <div>
                     <label for="font-select" class="block text-sm font-medium text-secondary mb-1">Font</label>
                     <select id="font-select" class="form-input rounded-md p-2 w-full">
                         <option value="'Inter', sans-serif">Inter (Sans-Serif)</option>
                         <option value="'Roboto Slab', serif">Roboto Slab (Serif)</option>
                         <option value="'Fira Code', monospace">Fira Code (Monospace)</option>
                         <option value="'Comic Neue', cursive">Comic Sans</option>
                     </select>
                 </div>
                 <div>
                     <label for="bg-image-url" class="block text-sm font-medium text-secondary mb-1">Background Image URL</label>
                     <div class="flex gap-2">
                         <input type="text" id="bg-image-url" placeholder="Paste image URL..." class="form-input rounded-md p-2 w-full">
                         <button id="remove-bg-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded-md" aria-label="Remove background image">X</button>
                     </div>
                 </div>
                 <div>
                     <label class="block text-sm font-medium text-secondary mb-1">YouTube Player</label>
                     <div class="space-y-2 mt-2 p-3 rounded-md" style="background-color: rgba(0,0,0,0.2);">
                         <label for="youtube-tint-toggle" class="flex items-center justify-between cursor-pointer">
                             <span class="text-sm">Enable Video Tint</span>
                             <input type="checkbox" id="youtube-tint-toggle" class="form-input-toggle">
                         </label>
                         <label for="youtube-blur-toggle" class="flex items-center justify-between cursor-pointer">
                             <span class="text-sm">Blur Video Player</span>
                              <input type="checkbox" id="youtube-blur-toggle" class="form-input-toggle">
                         </label>
                     </div>
                 </div>
                 <div>
                     <label class="block text-sm font-medium text-secondary mb-1">Focus Mode</label>
                     <div class="space-y-2 mt-2 p-3 rounded-md" style="background-color: rgba(0,0,0,0.2);">
                         <label for="focus-shield-toggle" class="flex items-center justify-between cursor-pointer">
                             <span class="text-sm">Enable Focus Shield</span>
                             <input type="checkbox" id="focus-shield-toggle" class="form-input-toggle">
                         </label>
                     </div>
                 </div>
            </div>
            <div class="flex justify-between items-center mt-6">
                <button type="button" id="reset-dashboard-btn" class="flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path></svg>
                    <span>Reset Dashboard</span>
                </button>
                <button type="button" id="close-customize" class="btn-primary font-bold py-2 px-4 rounded-md">Close</button>
            </div>
            <div class="mt-6 pt-4 border-t" style="border-color: var(--border-color);">
                <h3 class="text-md font-semibold mb-3 text-secondary">Data Management</h3>
                <div class="flex flex-col sm:flex-row gap-3">
                    <button type="button" id="export-data-btn" class="flex-1 bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-md text-sm transition-colors">Export Data</button>
                    <button type="button" id="import-data-btn" class="flex-1 bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-md text-sm transition-colors">Import Data</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="confirm-modal" class="modal-overlay hidden">
        <div class="card w-11/12 max-w-sm">
            <h2 id="confirm-title" class="text-xl font-semibold mb-2">Are you sure?</h2>
            <p id="confirm-message" class="text-sm text-secondary mb-6"></p>
            <div class="flex justify-end gap-3">
                <button type="button" id="confirm-cancel-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-md">Cancel</button>
                <button type="button" id="confirm-ok-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md">Confirm</button>
            </div>
        </div>
    </div>

    <div id="mobile-alert" class="fixed bottom-4 left-4 right-4 bg-yellow-400 text-black p-3 text-center text-sm rounded-lg shadow-lg flex justify-between items-center hidden z-50">
        <span>For the best experience, try this on a desktop.</span>
        <button id="close-alert-btn" class="font-bold text-lg ml-4" aria-label="Close mobile alert">&times;</button>
    </div>

    <div id="info-modal" class="modal-overlay hidden">
	    <div class="card w-11/12 max-w-lg">
	        <!-- Tab Navigation -->
	        <nav class="tab-nav">
	            <button class="tab-btn active" data-tab="quick-start">Quick Start</button>
	            <button class="tab-btn" data-tab="whats-new">What's New</button>
	            <button class="tab-btn" data-tab="feedback">Feedback</button>
	            <button class="tab-btn" data-tab="about">About & Support</button>
	        </nav>
	
	        <!-- Tab Content Panels -->
	        <div>
	            <!-- Quick Start Panel -->
	            <div id="tab-quick-start" class="tab-content space-y-3 text-sm">
					<p><strong>🙏 NEXT MAJOR/FEATURE UPDATE AFTER JEE MAIN 2026 JAN ATTEMPT 🙏 (updation of april attempt, etc.)</strong></p>
					<p><strong>YOU CAN CHANGE JEE/NEET AND YEAR IN CUSTOMISE MENU</strong></p>
	                <p><strong>✨ Drag & Drop:</strong> Use the six-dot handle on any card to rearrange your layout.</p>
	                <p><strong>➕ Add Cards:</strong> Click the "Add Card" button in the header to create custom notes, to-do lists, graphs, and more.</p>
	                <p><strong>🎨 Customize:</strong> Click the "Customize" button to change your theme, font, and background image.</p>
	                <p>Kindly refrain from tapping the top heading of the page (ex. JEE 2026), 3 times in successive continuation please.</p>
	            </div>
	
	            <!-- What's New Panel -->
	            <div id="tab-whats-new" class="tab-content hidden space-y-3 text-sm">
	                <h3 class="text-md font-bold text-primary">Version 1.2 (October 2025)</h3>
	                <ul class="list-disc list-inside text-secondary space-y-2">
	                    <li><strong>Enhanced Mock Test Analysis:</strong> You can now input subject-wise marks (P/C/M) and toggle their visibility on the graph.</li>
	                    <li><strong>Smarter Syncing:</strong> Implemented debouncing and caching to drastically reduce database usage and improve performance.</li>
	                    <li><strong>Persistent Floating Timer:</strong> The Picture-in-Picture window for the study logger now stays open until you return to the tab.</li>
	                </ul>
	            </div>
	
	            <!-- Feedback Panel -->
	            <div id="tab-feedback" class="tab-content hidden space-y-4 text-sm text-center">
	                 <p>Have an idea or found a bug? Join the community!</p>
	                 <a href="https://t.me/studylocus" target="_blank" class="btn-primary inline-block">Join the Telegram Group</a>
	                 <p class="text-xs text-secondary">You can also submit feedback or report issues on the project's GitHub page.</p>
	            </div>
	
	            <!-- About & Support Panel -->
	            <div id="tab-about" class="tab-content hidden space-y-3 text-sm">
	                <p><strong>Created by:</strong> <a href="https://github.com/svalordev" target="_blank">Shaurya Pratap Singh</a></p>
	                <p><strong>Project Repository:</strong> <a href="https://github.com/SvalTech/studylocus/" target="_blank">View on GitHub</a></p>
	                <div class="border-t border-gray-700 my-4"></div>
	                <p>Enjoying StudyLocus? Your support helps keep the project running and ad-free. Thank you!</p>
	                <div class="text-center mt-2">
	                    <a href="https://buymeacoffee.com/svalordev" target="_blank" class="btn-primary inline-block">Support the Project</a>
	                </div>
	            </div>
	        </div>
	        
	        <div class="flex justify-end mt-6">
	            <button type="button" id="close-info-modal" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-md">Close</button>
	        </div>
	    </div>
	</div>

    <div class="fab-container">
        <div class="fab-menu card p-2 space-y-1">
             <h3 class="text-sm font-bold px-2 text-secondary">sval.tech</h3>
             <a href="#" class="flex items-center gap-2 p-2 rounded-md hover:bg-gray-700/50">
                 <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M7 3v18"></path><path d="M12 3v18"></path><path d="M17 3v18"></path><path d="M3 7.5h18"></path><path d="M3 12h18"></path><path d="M3 16.5h18"></path></svg>
                 <span>Dashboard</span>
             </a>
             <a href="https://svaltech.github.io/syllabustracker" target="_blank" class="flex items-center gap-2 p-2 rounded-md hover:bg-gray-700/50">
                 <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"></path><path d="M14 2v4a2 2 0 0 0 2 2h4"></path><path d="m10 14-2 2 2 2"></path><path d="m14 6-2 2 2 2"></path></svg>
                 <span>Syllabus Tracker</span>
             </a>
        </div>
        <button class="w-14 h-14 rounded-full bg-gray-800 shadow-lg flex items-center justify-center text-white hover:bg-gray-700 transition-colors" aria-label="Toggle sval.tech products menu">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>
        </button>
    </div>

    <input type="file" id="import-file-input" class="hidden" accept=".json">

    <div id="god-mode-panel" class="hidden fixed bottom-4 left-4 card p-4 w-64 z-50 space-y-3">
        <h3 class="text-lg font-bold text-center" style="color: var(--accent-color);">-- GOD MODE --</h3>
        <p class="text-xs text-secondary text-center">Ultimate power is now yours.</p>
        <div class="border-t border-[var(--border-color)]"></div>
        <div class="space-y-2">
            <button id="god-mode-theme-btn" class="w-full bg-green-700 hover:bg-green-800 text-white font-bold py-2 px-4 rounded-md text-sm">Matrix Theme</button>
            <button id="god-mode-complete-tasks-btn" class="w-full bg-sky-600 hover:bg-sky-700 text-white font-bold py-2 px-4 rounded-md text-sm">Complete All Tasks</button>
            <button id="god-mode-perfect-score-btn" class="w-full bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-md text-sm">Get Perfect Score</button>
            <button id="god-mode-timewarp-btn" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded-md text-sm">Time Warp (+7 Days)</button>
            <button id="god-mode-scramble-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-md text-sm">Scramble Layout</button>
            <button id="god-mode-nuke-btn" class="w-full bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-md text-sm">NUKE</button>
        </div>
        <button id="god-mode-close-btn" class="absolute top-2 right-2 text-secondary hover:text-primary" aria-label="Close God Mode Panel">&times;</button>
    </div>
    
    <script>

	function debounce(t,e){let o;return function(...n){clearTimeout(o),o=setTimeout((()=>t.apply(this,n)),e)}}const firebaseConfig={apiKey:"AIzaSyAO9ya8gHtVbMfxcnAAJrz6FdYWvIRqgBY",authDomain:"studydashboard-2a3eb.firebaseapp.com",projectId:"studydashboard-2a3eb",storageBucket:"studydashboard-2a3eb.firebasestorage.app",messagingSenderId:"79210973277",appId:"1:79210973277:web:cc0a5fa86729fd6d3f65b4",measurementId:"G-TE7Z0SR8L1"};firebase.initializeApp(firebaseConfig);const auth=firebase.auth(),db=firebase.firestore();let currentUser=null,syncTimeout=null;document.addEventListener("DOMContentLoaded",(()=>{const t={tests:"jeePartTests_v2",layout:"jeeDashboardLayout_v3",customCards:"jeeCustomCards_v3",settings:"jeeDashboardSettings_v3",mobileAlertDismissed:"jeeMobileAlertDismissed_v1",cardProps:"jeeCardProps_v2",pomodoroState:"jeePomodoroState_v1",timeLoggerState:"jeeTimeLoggerState_v1",studyLogs:"jeeStudyLogs_v1"},e={JEE:{2026:new Date("2026-01-22T00:00:00"),2027:new Date("2027-01-21T00:00:00")},NEET:{2026:new Date("2026-05-03T00:00:00"),2027:new Date("2027-05-02T00:00:00")}},o=JSON.parse(localStorage.getItem(t.settings)),n={tests:JSON.parse(localStorage.getItem(t.tests))||{},customCards:JSON.parse(localStorage.getItem(t.customCards))||[{id:"default-todo",type:"todo",title:"My Tasks",content:[{text:"Solve 20 Physics problems",completed:!1},{text:"Revise Organic Chemistry",completed:!0},{text:"Take a short break!",completed:!1}]},{id:"default-line-graph",type:"line-graph",title:"Mock Test Progress",content:[{name:"Test 1",marks:120,maxMarks:300},{name:"Test 2",marks:145,maxMarks:300},{name:"Test 3",marks:160,maxMarks:300}]},{id:"default-note",type:"note",title:"Welcome!",content:"Welcome to your new dashboard! You can drag, resize, and delete these cards. Add your own from the top right. Best of luck in your journey!"},{id:"default-study-logger",type:"time-logger",title:"Study Log",content:[]}],layout:JSON.parse(localStorage.getItem(t.layout))||["countdown","graph","default-todo","default-study-logger","default-note","default-line-graph","tests","quote","time"],settings:{theme:"default",font:"'Inter', sans-serif",bgUrl:"",examType:"JEE",examYear:"2026",youtubeTintEnabled:!0,youtubeBlurEnabled:!1,focusShieldEnabled:!1,userSubjects:[],...o},cardProps:JSON.parse(localStorage.getItem(t.cardProps))||{graph:{colspan:2},"default-line-graph":{colspan:1},"default-study-logger":{colspan:1}},pomodoroState:JSON.parse(localStorage.getItem(t.pomodoroState))||{},timeLoggerState:JSON.parse(localStorage.getItem(t.timeLoggerState))||{},studyLogs:JSON.parse(localStorage.getItem(t.studyLogs))||{},chartInstances:{},activeTimer:{cardId:null,type:null,unfocusedTime:0,unfocusedStart:0},save(e){localStorage.setItem(t[e],JSON.stringify(this[e])),v(e)},saveSettings(){localStorage.setItem(t.settings,JSON.stringify(this.settings)),v("settings")}},a=[{text:"The secret of getting ahead is getting started.",author:"Mark Twain"},{text:"It’s not whether you get knocked down, it’s whether you get up.",author:"Vince Lombardi"},{text:"Success is the sum of small efforts, repeated day in and day out.",author:"Robert Collier"},{text:"The expert in anything was once a beginner.",author:"Helen Hayes"},{text:"Believe you can and you're halfway there.",author:"Theodore Roosevelt"},{text:"The difference between ordinary and extraordinary is that little extra.",author:"Jimmy Johnson"},{text:"A person who never made a mistake never tried anything new.",author:"Albert Einstein"},{text:"The harder I work, the luckier I get.",author:"Samuel Goldwyn"},{text:"Success is not final, failure is not fatal: it is the courage to continue that counts.",author:"Winston Churchill"},{text:"Strive for progress, not perfection.",author:"Unknown"},{text:"Genius is one percent inspiration and ninety-nine percent perspiration.",author:"Thomas A. Edison"},{text:"It does not matter how slowly you go as long as you do not stop.",author:"Confucius"},{text:"Doubt kills more dreams than failure ever will.",author:"Suzy Kassem"},{text:"Push yourself, because no one else is going to do it for you.",author:"Unknown"},{text:"If you want to shine like a sun, first burn like a sun.",author:"A. P. J. Abdul Kalam"},{text:"The important thing is not to stop questioning. Curiosity has its own reason for existing.",author:"Albert Einstein"},{text:"We are what we repeatedly do. Excellence, then, is not an act, but a habit.",author:"Aristotle"},{text:"The chapters you study today will decide the chapters of your life tomorrow.",author:"Unknown"},{text:"Your toughest competition is the person you were yesterday.",author:"Unknown"},{text:"Rank is just a number. Knowledge and skill are the real assets.",author:"Unknown"},{text:"Dream is not that which you see while sleeping it is something that does not let you sleep.",author:"A. P. J. Abdul Kalam"},{text:"Focus on the process, not the outcome. The right process will lead to the right outcome.",author:"Unknown"}],s=[{text:"Kyu nahi ho rahi padhai?",author:"Alakh Pandey"},{text:"System phaad denge!",author:"A wise man"},{text:"Physics is not a subject, it's an emotion.",author:"Alakh Pandey"},{text:"Aag laga denge!",author:"Revolutionaries"},{text:"Mehnat karta hu bhai",author:"Basava Reddy"}],r=[{text:"Chaitanya is a noob 🤓",author:"Everyone"},{text:"I love Organic Chemistry 🤓",author:"Chaitanya (probably)"},{text:"Isomerism is my favorite topic 🤓",author:"Definitely Chaitanya"},{text:"Just like us guys 🤓",author:"Chaitanya the moron"}],i={body:document.body,mainTitle:document.getElementById("main-title"),dashboardGrid:document.getElementById("dashboard-grid"),authContainer:document.getElementById("auth-container"),syncStatus:document.getElementById("sync-status"),modals:{addCard:document.getElementById("add-card-modal"),customize:document.getElementById("customize-modal"),info:document.getElementById("info-modal"),confirm:document.getElementById("confirm-modal")},buttons:{addCard:document.getElementById("add-card-btn"),cancelAddCard:document.getElementById("cancel-add-card"),customize:document.getElementById("customize-btn"),closeCustomize:document.getElementById("close-customize"),closeCustomizeIcon:document.getElementById("close-customize-icon-btn"),removeBg:document.getElementById("remove-bg-btn"),closeAlert:document.getElementById("close-alert-btn"),resetDashboard:document.getElementById("reset-dashboard-btn"),info:document.getElementById("info-btn"),closeInfo:document.getElementById("close-info-modal"),exportData:document.getElementById("export-data-btn"),importData:document.getElementById("import-data-btn"),confirmOk:document.getElementById("confirm-ok-btn"),confirmCancel:document.getElementById("confirm-cancel-btn"),zenModeBtn:document.getElementById("zen-mode-btn"),exitZenBtn:document.getElementById("exit-zen-btn"),godModeClose:document.getElementById("god-mode-close-btn")},forms:{newCard:document.getElementById("new-card-form")},inputs:{cardType:document.getElementById("new-card-type"),cardContent:document.getElementById("new-card-content"),theme:document.getElementById("theme-select"),font:document.getElementById("font-select"),bgUrl:document.getElementById("bg-image-url"),examType:document.getElementById("exam-type-select"),examYear:document.getElementById("exam-year-select"),importFile:document.getElementById("import-file-input"),youtubeTintToggle:document.getElementById("youtube-tint-toggle"),youtubeBlurToggle:document.getElementById("youtube-blur-toggle"),focusShieldToggle:document.getElementById("focus-shield-toggle")},mobileAlert:document.getElementById("mobile-alert"),confirmTitle:document.getElementById("confirm-title"),confirmMessage:document.getElementById("confirm-message"),godModePanel:document.getElementById("god-mode-panel")};let d=null,l=null,c=null;auth.onAuthStateChanged((t=>{t?(currentUser=t,p(t)):(currentUser=null,g())}));const u=()=>{const t=new firebase.auth.GoogleAuthProvider;auth.signInWithPopup(t).catch((t=>{console.error("Authentication Error:",t)}))},m=()=>{sessionStorage.removeItem("cloud_data_loaded"),auth.signOut()},g=()=>{if(currentUser){i.authContainer.innerHTML=`\n                    <div class="relative" id="user-menu-container">\n                        <button id="user-menu-button" title="User Menu" class="flex items-center justify-center w-10 h-10 rounded-full transition-colors hover:bg-white/20 sm:w-auto sm:h-auto sm:px-2 sm:py-1">\n                            <img src="${currentUser.photoURL}" alt="${currentUser.displayName}" class="w-8 h-8 rounded-full pointer-events-none" />\n                            <span class="text-sm font-semibold hidden sm:inline ml-2 pointer-events-none">${currentUser.displayName.split(" ")[0]}</span>\n                        </button>\n                        <div id="user-menu-dropdown" class="card absolute right-0 mt-2 w-48 p-2 hidden z-50">\n                            <div class="px-2 py-1 mb-1 border-b" style="border-color: var(--border-color);">\n                                <p class="text-sm font-semibold truncate" title="${currentUser.displayName}">${currentUser.displayName}</p>\n                                <p class="text-xs text-secondary truncate" title="${currentUser.email}">${currentUser.email}</p>\n                            </div>\n                            <button id="sign-out-btn" class="w-full text-left flex items-center gap-2 p-2 rounded-md hover:bg-white/10 transition-colors">\n                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>\n                                <span>Sign Out</span>\n                            </button>\n                        </div>\n                    </div>\n                `;const t=i.authContainer.querySelector("#user-menu-button"),e=i.authContainer.querySelector("#user-menu-dropdown"),o=i.authContainer.querySelector("#sign-out-btn");t.addEventListener("click",(t=>{t.stopPropagation(),e.classList.toggle("hidden")})),o.addEventListener("click",m)}else i.authContainer.innerHTML='<button id="sign-in-btn" class="flex items-center justify-center w-10 h-10 rounded-full transition-colors hover:bg-white/20 sm:w-auto sm:px-3 sm:py-2"><svg class="w-5 h-5" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <path d="M47.532 24.552c0-1.566-.14-3.084-.404-4.548H24.5v8.58h12.944c-.566 2.76-2.213 5.108-4.72 6.708v5.524h7.112c4.162-3.832 6.596-9.42 6.596-16.264z" fill="#4285F4"/><path d="M24.5 48c6.48 0 11.944-2.14 15.928-5.788l-7.112-5.524c-2.14 1.44-4.884 2.292-7.816 2.292-6.004 0-11.084-4.04-12.9-9.492H4.42v5.7c3.48 6.912 10.32 11.532 18.08 11.532l2 .28z" fill="#34A853"/><path d="M11.6 28.98c-.34-.996-.54-2.052-.54-3.144s.2-2.148.54-3.144V16.992H4.42C2.852 20.04 2 23.436 2 27.024c0 3.588.852 6.984 2.42 10.032l7.18-5.7v-.376z" fill="#FBBC05"/><path d="M24.5 9.8c3.516 0 6.66 1.212 9.128 3.54l6.32-6.32C36.44.88 30.98 0 24.5 0 16.74 0 9.9 4.62 6.42 11.532l7.18 5.7c1.816-5.452 6.896-9.432 12.9-9.432z" fill="#EA4335"/>\n                        </svg><span class="text-sm font-semibold hidden sm:inline ml-2">Sign In</span></button>',i.authContainer.querySelector("#sign-in-btn").addEventListener("click",u)},p=async t=>{g();const e=db.collection("users").doc(t.uid),o=await e.get();o.exists?h(o.data()):y(e)},h=e=>{if("true"===sessionStorage.getItem("cloud_data_loaded"))return void console.log("Cloud data already loaded this session. Skipping redundant load.");console.log("Loading data from cloud...");let o=!1;for(const n in t)if(e[n]){const a=localStorage.getItem(t[n]),s=JSON.stringify(e[n]);a!==s&&(localStorage.setItem(t[n],s),o=!0)}o&&(sessionStorage.setItem("cloud_data_loaded","true"),location.reload())},y=e=>{console.log("New user detected. Migrating local data to cloud...");const o={};for(const e in t){const n=localStorage.getItem(t[e]);n&&(o[e]=JSON.parse(n))}Object.keys(o).length>0&&e.set(o).then((()=>b("Synced"))).catch((t=>console.error("Migration failed:",t)))},b=t=>{clearTimeout(syncTimeout),i.syncStatus.textContent=t,i.syncStatus.style.opacity=1,"Saving..."!==t&&(syncTimeout=setTimeout((()=>{i.syncStatus.style.opacity=0}),2e3))},f=debounce((e=>{if(!currentUser)return;const o=db.collection("users").doc(currentUser.uid),n=localStorage.getItem(t[e]);if(n){const t={[e]:JSON.parse(n)};o.set(t,{merge:!0}).then((()=>{console.log(`Debounced sync for '${e}' successful.`),b("All changes saved")})).catch((t=>{b("Sync Error"),console.error("Firestore sync error:",t)}))}}),1e4),v=t=>{currentUser&&(b("Saving..."),f(t))};let S=null;function x(t,e,o="Are you sure?"){i.confirmTitle.textContent=o,i.confirmMessage.textContent=t,S=e,i.modals.confirm.classList.remove("hidden")}const L=t=>`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`,E=()=>{const{examType:t,examYear:o}=n.settings;return e[t]?.[o]||new Date},w=t=>`${Math.floor(t/3600).toString().padStart(2,"0")}:${Math.floor(t%3600/60).toString().padStart(2,"0")}:${Math.floor(t%60).toString().padStart(2,"0")}`,T=t=>{const e=Math.floor(t/3600),o=Math.floor(t%3600/60);let n="";return e>0&&(n+=`${e}h `),(o>0||e>0)&&(n+=`${o}m`),""===n&&(n=t%60+"s"),n.trim()};function I(){"visible"===document.visibilityState&&d&&d.close()}function C(){if(!d||!l)return;const t=document.querySelector(`[data-card-id="${l}"] .timer-display`),e=d.document.getElementById("pip-timer");t&&e&&(e.textContent=t.textContent)}function k(){if(!d||!l)return;const t=n.timeLoggerState[l];if(!t)return;const e=d.document.getElementById("pip-start-pause-btn"),o=d.document.getElementById("pip-log-btn");e&&(e.textContent=t.isRunning?"Pause":"Start"),o&&(o.disabled=t.accumulatedTime<60)}const B={countdown:{templateId:"countdown-template",isDefault:!0,render:t=>{const e=E()-new Date;t.querySelector('[data-value="days"]').innerText=Math.floor(e/864e5).toString().padStart(2,"0"),t.querySelector('[data-value="hours"]').innerText=Math.floor(e/36e5%24).toString().padStart(2,"0"),t.querySelector('[data-value="minutes"]').innerText=Math.floor(e/6e4%60).toString().padStart(2,"0"),t.querySelector('[data-value="seconds"]').innerText=Math.floor(e/1e3%60).toString().padStart(2,"0")}},time:{templateId:"time-template",isDefault:!0,render:t=>{const e=new Date;t.querySelector('[data-value="time"]').textContent=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}),t.querySelector('[data-value="date"]').textContent=e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}},graph:{templateId:"graph-template",isDefault:!0,render:t=>{const e=t.querySelector("#contribution-graph");e.innerHTML="";const o=new Date;o.setHours(0,0,0,0);const a=(new Date).getFullYear();let s=new Date(`${a}-01-01T00:00:00`);const r=E();for(r.setHours(0,0,0,0);s<=r;){const t=document.createElement("div"),a=document.createElement("span"),i=L(s);t.className="day",t.dataset.date=i,a.className="tooltip";let d="day-future",l=s.toDateString();if(s<o&&(d="day-past"),s.getTime()===o.getTime()&&(d="day-today",l+=" - Today"),n.tests[i]){d="day-part-test";const t=Math.ceil((new Date(i)-o)/864e5);l=`${n.tests[i]} (${t} days from now)`}s.getTime()===r.getTime()&&(d="day-exam",l+=" - Exam!"),t.classList.add(d),a.textContent=l,t.appendChild(a),e.appendChild(t),s.setDate(s.getDate()+1)}}},tests:{templateId:"tests-template",isDefault:!0,render:t=>{const e=t.querySelector("#test-list");e.innerHTML="";const o=Object.keys(n.tests).sort();0!==o.length?o.forEach((t=>{const o=document.createElement("li");o.className="flex justify-between items-center bg-gray-800 p-2 rounded-md",o.innerHTML=`<div class="flex flex-col"><span class="font-semibold text-sm">${n.tests[t]}</span><span class="text-xs text-secondary">${new Date(t+"T00:00:00").toDateString()}</span></div><button data-date="${t}" class="delete-test-btn text-red-500 hover:text-red-400 font-semibold text-xs">Delete</button>`,e.appendChild(o)})):e.innerHTML='<li class="text-secondary px-2 text-sm">No tests scheduled.</li>'}},quote:{templateId:"quote-template",isDefault:!0,render:t=>{let e=a;"alakh-pandey"===n.settings.theme&&(e=s),"chaitanya-noob"===n.settings.theme&&(e=r);const{text:o,author:i}=e[Math.floor(Math.random()*e.length)];t.querySelector("#quote").textContent=`"${o}"`,t.querySelector("#author").textContent=`- ${i}`}},note:{templateId:"note-card-template",render:(t,e)=>{t.querySelector(".card-content").textContent=e.content}},todo:{templateId:"todo-card-template",render:(t,e)=>{const o=t.querySelector(".todo-list"),n=t.querySelector(".progress-bar");if(o.innerHTML="",Array.isArray(e.content)){const t=e.content.length,a=e.content.filter((t=>t.completed)).length,s=t>0?a/t*100:0;n.style.width=`${s}%`,0===t?o.innerHTML='<li class="text-secondary px-2 text-sm">No tasks yet. Add one below!</li>':e.content.forEach(((t,e)=>{const n=document.createElement("li");n.className="flex items-center gap-3 p-2 rounded-md hover:bg-white/5 transition-colors todo-item "+(t.completed?"completed":""),n.dataset.index=e,n.innerHTML=`<input type="checkbox" ${t.completed?"checked":""} class="todo-checkbox"><span class="flex-grow text-sm">${t.text}</span><button class="delete-todo-item" aria-label="Delete task">×</button>`,o.appendChild(n)}))}}},"line-graph":{templateId:"line-graph-card-template",render:(t,e)=>{const o=t.querySelector(".marks-list");o.innerHTML="",e.content.forEach(((t,e)=>{const n=document.createElement("li");n.className="flex justify-between items-center text-xs bg-gray-800 p-2 rounded",n.innerHTML=`\n\t\t\t                <div class="flex-grow">\n\t\t\t                    <strong>${t.name}</strong>: ${t.total??t.marks} / ${t.maxMarks}\n\t\t\t                    <span class="text-gray-400 ml-2">${t.subjects?`(P:${t.subjects.physics}, C:${t.subjects.chemistry}, M:${t.subjects.maths})`:"(No subject data)"}</span>\n\t\t\t                </div>\n\t\t\t                <button data-index="${e}" class="delete-mark-item text-red-500 px-1" aria-label="Delete mark entry">×</button>`,o.appendChild(n)}));const a=t.querySelector(".marks-chart").getContext("2d");n.chartInstances[e.id]&&n.chartInstances[e.id].destroy();const s={total:getComputedStyle(document.documentElement).getPropertyValue("--accent-color").trim(),physics:"#3b82f6",chemistry:"#10b981",maths:"#f97316"},r=["total","physics","chemistry","maths"].map((t=>({label:t.charAt(0).toUpperCase()+t.slice(1),data:e.content.map((e=>"total"===t?e.total??e.marks:e.subjects?e.subjects[t]:null)),borderColor:s[t],backgroundColor:`${s[t]}20`,fill:!0,tension:.3,pointBackgroundColor:s[t],borderWidth:2,hidden:"total"!==t}))),i=e.content.length>0?Math.max(...e.content.map((t=>t.maxMarks||0))):300,d=getComputedStyle(document.documentElement).getPropertyValue("--text-secondary").trim(),l=getComputedStyle(document.documentElement).getPropertyValue("--border-color").trim(),c=new Chart(a,{type:"line",data:{labels:e.content.map((t=>t.name)),datasets:r},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,max:i,ticks:{color:d},grid:{color:l}},x:{ticks:{color:d},grid:{color:"transparent"}}}}});n.chartInstances[e.id]=c;const u=t.querySelector(".chart-toggles");u.addEventListener("click",(t=>{if("BUTTON"===t.target.tagName){const e=t.target.dataset.subject,o=c.data.datasets.findIndex((t=>t.label.toLowerCase()===e));o>-1&&(c.data.datasets[o].hidden=!c.data.datasets[o].hidden,c.update(),u.querySelectorAll("button").forEach((t=>{const e=c.data.datasets.findIndex((e=>e.label.toLowerCase()===t.dataset.subject));c.data.datasets[e].hidden?(t.style.backgroundColor="transparent",t.style.borderColor="#4b5563",t.style.color="var(--text-primary)"):(t.style.backgroundColor=s[t.dataset.subject],t.style.borderColor=s[t.dataset.subject],t.style.color="white")})))}})),u.querySelector("button").click(),u.querySelector("button").click()}},pomodoro:{templateId:"pomodoro-card-template",render:(t,e)=>{const o=n.pomodoroState[e.id]||{mode:"pomodoro",time:1500,isRunning:!1,intervalId:null,durations:{pomodoro:25,shortBreak:5,longBreak:15}};n.pomodoroState[e.id]=o;const a=Math.floor(o.time/60).toString().padStart(2,"0"),s=(o.time%60).toString().padStart(2,"0");t.querySelector(".timer-display").textContent=`${a}:${s}`,t.querySelectorAll(".pomodoro-btn").forEach((t=>{t.classList.toggle("active",t.dataset.mode===o.mode)})),t.querySelector(".start-pause-btn").textContent=o.isRunning?"PAUSE":"START",t.querySelector('[data-mode="pomodoro"].pomodoro-duration-input').value=o.durations.pomodoro,t.querySelector('[data-mode="shortBreak"].pomodoro-duration-input').value=o.durations.shortBreak,t.querySelector('[data-mode="longBreak"].pomodoro-duration-input').value=o.durations.longBreak}},youtube:{templateId:"youtube-card-template",render:(t,e)=>{const o=t.querySelector(".youtube-iframe"),a=e.content;let s="";if(a)try{const t=new URL(a);s=t.hostname.includes("youtu.be")?t.pathname.slice(1):t.searchParams.get("v")}catch(t){console.error("Invalid YouTube URL")}o.src=s?`https://www.youtube.com/embed/${s}`:"";const r=t.querySelector(".youtube-container");r.classList.toggle("tint-disabled",!n.settings.youtubeTintEnabled),r.classList.toggle("blurred",n.settings.youtubeBlurEnabled)}},"time-logger":{templateId:"time-logger-card-template",render:(t,e)=>{const o=n.timeLoggerState[e.id]||{isRunning:!1,accumulatedTime:0,currentSubject:"Physics",intervalId:null};n.timeLoggerState[e.id]=o,t.querySelector(".timer-display").textContent=w(o.accumulatedTime),t.querySelector(".start-pause-btn").textContent=o.isRunning?"PAUSE":"START";const a=`subject-select-${e.id}`;t.querySelector('label[for="subject-select"]').setAttribute("for",a);const s=t.querySelector(".subject-select");s.id=a;const r=[...new Set(["Physics","Chemistry","Maths","Biology","Zoology","Botany",...n.settings.userSubjects||[]])];s.innerHTML=r.map((t=>`<option>${t}</option>`)).join("")+'<option value="add_new">Add New Subject...</option>',s.value=o.currentSubject;const i=t.querySelector(".study-log-list"),d=t.querySelector(".total-study-time");i.innerHTML="";const l=L(new Date),c=n.studyLogs[l]||{},u=Object.values(c).reduce(((t,e)=>t+e),0);d&&(d.textContent=`Total: ${T(u)}`),0===Object.keys(c).length?i.innerHTML='<li class="text-secondary px-2 text-sm">No sessions logged today.</li>':Object.entries(c).forEach((([t,e])=>{const o=document.createElement("li");o.className="flex justify-between items-center",o.innerHTML=`<span>${t}</span><div class="flex items-center gap-2"><span class="font-semibold">${T(e)}</span><button data-subject="${t}" class="delete-log-item text-red-500 hover:text-red-400 font-semibold px-2 py-1 text-xs leading-none rounded-sm" aria-label="Delete ${t} log">×</button></div>`,i.appendChild(o)}))}}};function q(){Object.values(n.chartInstances).forEach((t=>t.destroy())),n.chartInstances={},i.dashboardGrid.innerHTML="";const t=n.customCards.map((t=>t.id));n.layout=n.layout.filter((e=>B[e]?.isDefault||t.includes(e))),n.customCards.forEach((t=>{n.layout.includes(t.id)||n.layout.push(t.id)})),n.save("layout"),n.layout.forEach((t=>{const e=n.customCards.find((e=>e.id===t)),o=e?e.type:t,a=B[o];if(a){const s=document.getElementById(a.templateId).content.cloneNode(!0),r=s.querySelector(".card");r.dataset.cardId=t;const d=n.cardProps[t]||{colspan:"graph"===o||"line-graph"===o||"youtube"===o||"time-logger"===o?2:1};if(n.cardProps[t]=d,2===d.colspan&&r.classList.add("md:col-span-2"),e)r.querySelector(".card-title").textContent=e.title;else if("chaitanya-noob"===n.settings.theme){const t=r.querySelector("h2");t&&(t.textContent+=" 🤓")}i.dashboardGrid.appendChild(s)}})),i.dashboardGrid.querySelectorAll(".card").forEach(((t,e)=>{const o=t.dataset.cardId,a=n.customCards.find((t=>t.id===o)),s=a?a.type:o,r=B[s];r&&r.render(t,a)}))}function D(){const t=n.settings.youtubeTintEnabled,e=n.settings.youtubeBlurEnabled;i.inputs.youtubeTintToggle&&(i.inputs.youtubeTintToggle.checked=t),i.inputs.youtubeBlurToggle&&(i.inputs.youtubeBlurToggle.checked=e),document.querySelectorAll('[data-card-type="youtube"] .youtube-container').forEach((o=>{o.classList.toggle("tint-disabled",!t),o.classList.toggle("blurred",e)}))}function M(){document.documentElement.dataset.theme=n.settings.theme,i.body.style.fontFamily=n.settings.font,"alakh-pandey"===n.settings.theme?i.body.style.backgroundImage="url(https://i.imgflip.com/8otyfs.jpg)":"chaitanya-noob"===n.settings.theme?i.body.style.backgroundImage="url(https://i.ibb.co/pv4BYhMs/Whats-App-Image-2025-08-06-at-16-12-41-4f47e159.jpg)":"god-mode"===n.settings.theme?i.body.style.backgroundImage="url('https://i.pinimg.com/originals/c5/9a/d2/c59ad2bd4ad2fbacd04017debc679ddb.gif')":i.body.style.backgroundImage=n.settings.bgUrl?`url(${n.settings.bgUrl})`:"none";const{examType:t,examYear:e}=n.settings;i.mainTitle.textContent=`${t} ${e}`,i.inputs.theme.value=n.settings.theme,i.inputs.font.value=n.settings.font,i.inputs.bgUrl.value=n.settings.bgUrl,i.inputs.examType.value=n.settings.examType,i.inputs.examYear.value=n.settings.examYear,i.inputs.focusShieldToggle.checked=n.settings.focusShieldEnabled,D()}i.dashboardGrid.addEventListener("click",(t=>{const e=t.target.closest(".card");if(!e)return;const o=e.dataset.cardId;if("quote"===o&&B.quote.render(e),t.target.closest(".delete-test-btn")&&(delete n.tests[t.target.closest(".delete-test-btn").dataset.date],n.save("tests"),q()),t.target.classList.contains("day")){const e=t.target.dataset.date;if(n.tests[e])delete n.tests[e],n.save("tests"),q();else{const t=i.dashboardGrid.querySelector("#add-test-form");t&&(t.date.value=e,t.name.focus())}}const a=n.customCards.find((t=>t.id===o));if(t.target.closest(".toggle-colspan-btn")){const t=n.cardProps[o]||{colspan:1};t.colspan=2===t.colspan?1:2,n.cardProps[o]=t,n.save("cardProps"),q()}if(t.target.closest(".delete-card-btn")&&a&&(n.customCards=n.customCards.filter((t=>t.id!==o)),delete n.cardProps[o],delete n.pomodoroState[o],delete n.timeLoggerState[o],n.save("customCards"),n.save("cardProps"),n.save("pomodoroState"),n.save("timeLoggerState"),q()),t.target.classList.contains("delete-log-item")){const e=t.target.closest(".card"),o=e.dataset.cardId,a=t.target.dataset.subject,s=L(new Date);if(n.studyLogs[s]&&void 0!==n.studyLogs[s][a]){delete n.studyLogs[s][a],0===Object.keys(n.studyLogs[s]).length&&delete n.studyLogs[s],n.save("studyLogs");const t=n.customCards.find((t=>t.id===o));B["time-logger"].render(e,t)}}if(t.target.closest(".pip-btn")){const t=n.customCards.find((t=>t.id===o));t&&"time-logger"===t.type&&async function(t,e){if("documentPictureInPicture"in window){d&&d.close();try{const o={width:320,height:155},n=await documentPictureInPicture.requestWindow(o);d=n,l=t,c=e,[...document.styleSheets].forEach((t=>{try{const e=[...t.cssRules].map((t=>t.cssText)).join(""),o=document.createElement("style");o.textContent=e,d.document.head.appendChild(o)}catch(t){console.warn("Cannot read cross-origin stylesheet",t)}}));const a=document.createElement("style");a.textContent='\n\t\t            body {\n\t\t                background-color: var(--card-bg-color);\n\t\t                color: var(--text-primary);\n\t\t                font-family: var(--font-family);\n\t\t                display: flex;\n\t\t                flex-direction: column;\n\t\t                align-items: center;\n\t\t                justify-content: center;\n\t\t                text-align: center;\n\t\t                padding: 1rem;\n\t\t                margin: 0;\n\t\t                box-sizing: border-box;\n\t\t                overflow: hidden;\n\t\t            }\n\t\t            h2 {\n\t\t                font-size: 0.9rem;\n\t\t                margin: 0 0 0.5rem 0;\n\t\t                color: var(--text-secondary);\n\t\t                font-weight: 600;\n\t\t            }\n\t\t            #pip-timer {\n\t\t\t\t\t    \n\t\t\t\t\t    font-size: clamp(1.5rem, 25vh, 7.5rem);\n\t\t\t\t\t    font-weight: 700;\n\t\t\t\t\t    line-height: 1; /* Helps with vertical alignment */\n\t\t\t\t\t    letter-spacing: 0.05em;\n\t\t\t\t\t    font-family: \'Fira Code\', monospace;\n\t\t\t\t\t}\n\t\t            #pip-controls {\n\t\t                display: flex;\n\t\t                gap: 0.75rem;\n\t\t                margin-top: 1rem;\n\t\t            }\n\t\t            #pip-controls button {\n\t\t                padding: 0.5rem 1.25rem;\n\t\t                font-size: 0.9rem;\n\t\t                font-weight: 600;\n\t\t                border: none;\n\t\t                border-radius: 8px;\n\t\t                cursor: pointer;\n\t\t                transition: transform 0.1s ease, filter 0.1s ease;\n\t\t            }\n\t\t            #pip-controls button:hover {\n\t\t                transform: translateY(-2px);\n\t\t                filter: brightness(1.1);\n\t\t            }\n\t\t            #pip-start-pause-btn {\n\t\t                background-color: var(--accent-color);\n\t\t                color: white; /* Default to white for most themes */\n\t\t            }\n\t\t            #pip-log-btn {\n\t\t                background-color: #16a34a; /* A nice, consistent green */\n\t\t                color: white;\n\t\t            }\n\t\t            #pip-log-btn:disabled {\n\t\t                background-color: #4b5563; /* Gray out when disabled */\n\t\t                cursor: not-allowed;\n\t\t                transform: none;\n\t\t                filter: none;\n\t\t            }\n\t\t            #pip-reset-btn {\n\t\t                background-color: transparent;\n\t\t                color: var(--text-secondary);\n\t\t            }\n\t\t            /* Fix for themes where button text should be dark */\n\t\t            [data-theme="light"] #pip-start-pause-btn,\n\t\t            [data-theme="alakh-pandey"] #pip-start-pause-btn {\n\t\t                 color: var(--bg-color);\n\t\t            }\n\t\t        ',d.document.head.appendChild(a),d.document.body.dataset.theme=document.body.dataset.theme||"default";const s=document.createElement("h2");s.textContent=document.querySelector(`[data-card-id="${t}"] .card-title`).textContent;const r=document.createElement("div");r.id="pip-timer";const i=document.createElement("div");i.id="pip-controls";const u=document.createElement("button");u.id="pip-start-pause-btn",u.addEventListener("click",(()=>window.timeLogger.toggle(l)));const m=document.createElement("button");m.id="pip-log-btn",m.textContent="Log",m.addEventListener("click",(()=>window.timeLogger.log(l)));const g=document.createElement("button");g.id="pip-reset-btn",g.textContent="Reset",g.addEventListener("click",(()=>window.timeLogger.reset(l))),i.append(u,m,g),d.document.body.append(s,r,i),document.addEventListener("visibilitychange",I),d.addEventListener("pagehide",(()=>{d=null,l=null,c=null,document.removeEventListener("visibilitychange",I)})),C(),k()}catch(t){console.error("PiP Error:",t),d=null}}else alert("Your browser does not support the Document Picture-in-Picture API required for this feature. Please try a recent version of Chrome or Edge on a desktop computer.")}(o,t.type)}if(a&&"todo"===a.type){const o=t.target.closest(".todo-item");if(o){const s=parseInt(o.dataset.index);t.target.closest(".delete-todo-item")?a.content.splice(s,1):t.target.classList.contains("todo-checkbox")&&(a.content[s].completed=!a.content[s].completed),n.save("customCards"),B.todo.render(e,a)}}if(a&&"line-graph"===a.type&&t.target.closest(".delete-mark-item")){const o=parseInt(t.target.closest(".delete-mark-item").dataset.index);a.content.splice(o,1),n.save("customCards"),B["line-graph"].render(e,a)}a&&"pomodoro"===a.type&&(t.target.classList.contains("pomodoro-btn")?$.setMode(o,t.target.dataset.mode):t.target.classList.contains("start-pause-btn")?$.toggle(o):t.target.classList.contains("reset-btn")&&$.reset(o)),a&&"time-logger"===a.type&&(t.target.classList.contains("start-pause-btn")?timeLogger.toggle(o):t.target.classList.contains("log-btn")?timeLogger.log(o):t.target.classList.contains("reset-btn")&&timeLogger.reset(o))})),i.dashboardGrid.addEventListener("change",(t=>{if(t.target.classList.contains("pomodoro-duration-input")){const e=t.target.closest(".card").dataset.cardId,o=t.target.dataset.mode;let n=parseInt(t.target.value);n<1&&(n=1,t.target.value=1),e&&o&&!isNaN(n)&&$.setDuration(e,o,n)}if(t.target.classList.contains("subject-select")){const e=t.target.closest(".card").dataset.cardId;timeLogger.changeSubject(e,t.target.value)}})),i.dashboardGrid.addEventListener("submit",(t=>{t.preventDefault();const e=t.target,o=e.closest(".card"),a=o.dataset.cardId;if("add-test-form"===e.id){const{date:t,name:o}=e.elements;t.value&&o.value.trim()&&(n.tests[t.value]=o.value.trim(),n.save("tests"),q(),e.reset())}else if(e.classList.contains("add-todo-form")){const t=n.customCards.find((t=>t.id===a)),s=e.querySelector("input"),r=s.value.trim();if("coco"===r.toLowerCase())return P||(P={theme:n.settings.theme,customCards:JSON.parse(JSON.stringify(n.customCards)),tests:JSON.parse(JSON.stringify(n.tests)),layout:[...n.layout]}),i.godModePanel.classList.remove("hidden"),(new Tone.Synth).toDestination().triggerAttackRelease("C4","0.5"),void(s.value="");if("doingocmakesmeexcited"===r.toLowerCase())return n.settings.theme="chaitanya-noob",n.saveSettings(),M(),q(),void(s.value="");t&&r&&(Array.isArray(t.content)||(t.content=[]),t.content.push({text:r,completed:!1}),n.save("customCards"),B.todo.render(o,t),s.value="")}else if(e.classList.contains("add-marks-form")){const t=n.customCards.find((t=>t.id===a)),{name:s,phy:r,chem:i,math:d,maxMarks:l}=e.elements;if(t&&s.value.trim()&&r.value&&i.value&&d.value&&l.value){Array.isArray(t.content)||(t.content=[]);const a=parseFloat(r.value),c=parseFloat(i.value),u=parseFloat(d.value),m=a+c+u;t.content.push({name:s.value.trim(),maxMarks:parseFloat(l.value),total:m,subjects:{physics:a,chemistry:c,maths:u}}),n.save("customCards"),B["line-graph"].render(o,t),e.reset()}}else if(e.classList.contains("update-youtube-form")){const t=n.customCards.find((t=>t.id===a)),s=e.querySelector("input");t&&s.value.trim()&&(t.content=s.value.trim(),n.save("customCards"),B.youtube.render(o,t))}})),i.buttons.addCard.addEventListener("click",(()=>i.modals.addCard.classList.remove("hidden"))),i.buttons.cancelAddCard.addEventListener("click",(()=>i.modals.addCard.classList.add("hidden"))),i.inputs.cardType.addEventListener("change",(t=>{const e="note"===t.target.value,o="youtube"===t.target.value;i.inputs.cardContent.style.display=e||o?"block":"none",i.inputs.cardContent.placeholder=o?"Paste YouTube video URL...":"Card Content (for notes)"})),i.forms.newCard.addEventListener("submit",(t=>{t.preventDefault();const e=i.inputs.cardType.value,o=i.forms.newCard.querySelector('input[type="text"]').value.trim();if(!o)return;const a={id:`custom-${Date.now()}`,type:e,title:o,content:"note"===e||"youtube"===e?i.inputs.cardContent.value.trim():[]};n.customCards.push(a);const s={colspan:"line-graph"===e||"youtube"===e||"time-logger"===e?2:1};"line-graph"===e&&(s.maxMarks=300),n.cardProps[a.id]=s,n.save("customCards"),n.save("cardProps"),q(),i.modals.addCard.classList.add("hidden"),i.forms.newCard.reset(),i.inputs.cardContent.style.display="block"}));const A=()=>i.modals.customize.classList.add("hidden");i.buttons.customize.addEventListener("click",(()=>i.modals.customize.classList.remove("hidden"))),i.buttons.closeCustomize.addEventListener("click",A),i.buttons.closeCustomizeIcon.addEventListener("click",A),i.modals.customize.addEventListener("click",(t=>{t.target===i.modals.customize&&A()}));const j=()=>{n.saveSettings(),M(),q()};i.inputs.examType.addEventListener("change",(()=>{n.settings.examType=i.inputs.examType.value,j()})),i.inputs.examYear.addEventListener("change",(()=>{n.settings.examYear=i.inputs.examYear.value,j()})),i.inputs.theme.addEventListener("change",(()=>{n.settings.theme=i.inputs.theme.value,n.saveSettings(),M(),q()})),i.inputs.font.addEventListener("change",(()=>{n.settings.font=i.inputs.font.value,n.saveSettings(),M()})),i.inputs.bgUrl.addEventListener("input",(()=>{n.settings.bgUrl=i.inputs.bgUrl.value,n.saveSettings(),M()})),i.buttons.removeBg.addEventListener("click",(()=>{n.settings.bgUrl="",n.saveSettings(),M()})),i.inputs.youtubeTintToggle.addEventListener("change",(()=>{n.settings.youtubeTintEnabled=i.inputs.youtubeTintToggle.checked,n.saveSettings(),D()})),i.inputs.youtubeBlurToggle.addEventListener("change",(()=>{n.settings.youtubeBlurEnabled=i.inputs.youtubeBlurToggle.checked,n.saveSettings(),D()})),i.inputs.focusShieldToggle.addEventListener("change",(()=>{const t=i.inputs.focusShieldToggle.checked;if(n.settings.focusShieldEnabled=t,n.saveSettings(),!t&&n.activeTimer.cardId){const{cardId:t,type:e}=n.activeTimer;"pomodoro"===e?$.stop(t):"time-logger"===e&&timeLogger.pause(t)}})),i.buttons.resetDashboard.addEventListener("click",(()=>{x("This will delete all custom cards and reset the layout to the default.",(()=>{Object.keys(t).forEach((e=>{"settings"!==e&&"mobileAlertDismissed"!==e&&localStorage.removeItem(t[e])})),location.reload()}),"Reset Dashboard?")})),i.buttons.exportData.addEventListener("click",(()=>{const e={};for(const o in t){const n=localStorage.getItem(t[o]);null!==n&&(e[o]=JSON.parse(n))}const o=JSON.stringify(e,null,2),n=new Blob([o],{type:"application/json"}),a=URL.createObjectURL(n),s=document.createElement("a");s.href=a;const r=(new Date).toISOString().slice(0,10);s.download=`studylocus-backup-${r}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)})),i.buttons.importData.addEventListener("click",(()=>{i.inputs.importFile.click()})),i.inputs.importFile.addEventListener("change",(e=>{const o=e.target.files[0];if(!o)return;const n=new FileReader;n.onload=e=>{try{const o=JSON.parse(e.target.result);if(!["layout","customCards","settings"].every((t=>t in o)))return void console.error("Import failed: The JSON file appears to be invalid or is not a valid dashboard backup.");x("This will overwrite your current dashboard configuration.",(()=>{localStorage.clear();for(const e in o)if(e in t){const n=t[e],a=o[e];null!=a&&localStorage.setItem(n,JSON.stringify(a))}location.reload()}),"Import Data?")}catch(t){console.error("Error importing data:",t)}finally{i.inputs.importFile.value=""}},n.readAsText(o)})),window.innerWidth<768&&"true"!==localStorage.getItem(t.mobileAlertDismissed)&&i.mobileAlert.classList.remove("hidden"),i.buttons.closeAlert.addEventListener("click",(()=>{i.mobileAlert.classList.add("hidden"),localStorage.setItem(t.mobileAlertDismissed,"true")})),i.buttons.info.addEventListener("click",(()=>i.modals.info.classList.remove("hidden"))),i.buttons.closeInfo.addEventListener("click",(()=>i.modals.info.classList.add("hidden"))),i.buttons.zenModeBtn.addEventListener("click",(()=>{i.body.classList.add("zen-mode"),i.buttons.exitZenBtn.classList.remove("hidden")})),i.buttons.exitZenBtn.addEventListener("click",(()=>{i.body.classList.remove("zen-mode"),i.buttons.exitZenBtn.classList.add("hidden")})),i.buttons.confirmCancel.addEventListener("click",(()=>{i.modals.confirm.classList.add("hidden"),S=null})),i.buttons.confirmOk.addEventListener("click",(()=>{"function"==typeof S&&S(),i.modals.confirm.classList.add("hidden"),S=null}));const $={tick(t){const e=n.pomodoroState[t];e.time>0?(e.time--,this.updateDisplay(t)):(this.stop(t),(new Tone.Synth).toDestination().triggerAttackRelease("C5","0.5"))},updateDisplay(t){const e=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);e&&B.pomodoro.render(e,{id:t});const o=n.pomodoroState[t];if(o.isRunning){const t=Math.floor(o.time/60).toString().padStart(2,"0"),e=(o.time%60).toString().padStart(2,"0");document.title=`${t}:${e} - Time to focus!`}else{const{examType:t,examYear:e}=n.settings;document.title=`${t} ${e} | StudyLocus`}},start(t,e=!1){const o=n.pomodoroState[t];if(!o.isRunning){if(o.isRunning=!0,!e){if(n.activeTimer.cardId!==t||"pomodoro"!==n.activeTimer.type){n.activeTimer.unfocusedTime=0;const e=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);if(e){const t=e.querySelector(".focus-status");t&&(t.textContent="")}}n.activeTimer.cardId=t,n.activeTimer.type="pomodoro",n.settings.focusShieldEnabled&&O()}o.intervalId=setInterval((()=>this.tick(t)),1e3),this.updateDisplay(t),n.save("pomodoroState")}},_internalPause(t){const e=n.pomodoroState[t];clearInterval(e.intervalId),e.isRunning=!1,this.updateDisplay(t)},stop(t){const e=n.pomodoroState[t];clearInterval(e.intervalId),n.activeTimer.cardId===t&&(n.activeTimer.cardId=null,n.activeTimer.type=null,n.settings.focusShieldEnabled&&U()),e.isRunning=!1,this.updateDisplay(t),n.save("pomodoroState")},toggle(t){n.pomodoroState[t].isRunning?this.stop(t):this.start(t)},reset(t){const e=n.pomodoroState[t];this.stop(t),e.time=60*e.durations[e.mode],this.updateDisplay(t),n.save("pomodoroState")},setMode(t,e){n.pomodoroState[t].mode=e,this.reset(t)},setDuration(t,e,o){const a=n.pomodoroState[t];a.durations[e]=o,a.mode===e&&this.reset(t),n.save("pomodoroState")}};window.timeLogger={tick(t){const e=n.timeLoggerState[t];if(e&&e.isRunning&&e.startTime){const o=Date.now()-e.startTime,n=e.accumulatedTime+Math.round(o/1e3),a=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);a&&(a.querySelector(".timer-display").textContent=w(n),C())}},start(t){const e=n.timeLoggerState[t];if(!e||e.isRunning)return;e.isRunning=!0,e.startTime=Date.now(),n.activeTimer.cardId=t,n.activeTimer.type="time-logger",n.settings.focusShieldEnabled&&O(),e.intervalId=setInterval((()=>this.tick(t)),1e3);const o=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);o&&(o.querySelector(".start-pause-btn").textContent="PAUSE"),n.save("timeLoggerState"),k()},pause(t,e=!0){const o=n.timeLoggerState[t];if(!o||!o.isRunning)return;clearInterval(o.intervalId);const a=Date.now()-o.startTime;if(o.accumulatedTime+=Math.round(a/1e3),o.isRunning=!1,o.startTime=null,o.intervalId=null,n.activeTimer.cardId===t&&(n.activeTimer.cardId=null,n.activeTimer.type=null,n.settings.focusShieldEnabled&&U()),n.save("timeLoggerState"),e){const e=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);e&&B["time-logger"].render(e,{id:t})}k(),C()},toggle(t){n.timeLoggerState[t].isRunning?this.pause(t):this.start(t)},log(t){this.pause(t,!1);const e=n.timeLoggerState[t];if(e.accumulatedTime<60){const e=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);if(e){const t=e.querySelector(".log-message");t&&(t.textContent="Minimum log time is 1 minute.",setTimeout((()=>{t&&(t.textContent="")}),3e3))}return void this.start(t)}const o=L(new Date);n.studyLogs[o]||(n.studyLogs[o]={});const a=e.currentSubject;n.studyLogs[o][a]=(n.studyLogs[o][a]||0)+e.accumulatedTime,n.save("studyLogs"),e.accumulatedTime=0,n.save("timeLoggerState"),q(),C(),k()},reset(t){this.pause(t,!1);n.timeLoggerState[t].accumulatedTime=0,n.save("timeLoggerState"),q(),C(),k()},changeSubject(t,e){const o=n.timeLoggerState[t],a=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);if("add_new"===e){const t=prompt("Enter new subject name:");t&&t.trim()?(n.settings.userSubjects||(n.settings.userSubjects=[]),n.settings.userSubjects.push(t.trim()),n.saveSettings(),o.currentSubject=t.trim(),q()):a&&(a.querySelector(".subject-select").value=o.currentSubject)}else o&&(o.currentSubject=e,n.save("timeLoggerState"))}};let P=null;i.body.addEventListener("click",(t=>{if(t.target.closest("#god-mode-panel")){const e=t.target.id;if("god-mode-close-btn"===e&&(i.godModePanel.classList.add("hidden"),P&&(n.settings.theme=P.theme,n.customCards=P.customCards,n.tests=P.tests,n.layout=P.layout,P=null,M(),q())),"god-mode-theme-btn"===e){const t=i.inputs.theme;if(!t.querySelector('[value="god-mode"]')){const e=document.createElement("option");e.value="god-mode",e.textContent="--- GOD MODE ---",t.appendChild(e)}n.settings.theme="god-mode",M(),q()}if("god-mode-complete-tasks-btn"===e&&(n.customCards.forEach((t=>{"todo"===t.type&&Array.isArray(t.content)&&t.content.forEach((t=>t.completed=!0))})),q()),"god-mode-perfect-score-btn"===e){const t=n.customCards.find((t=>"line-graph"===t.type));if(t&&Array.isArray(t.content)){const e="NEET"===n.settings.examType?720:300;t.content.push({name:"God Tier",marks:e,maxMarks:e}),q()}}if("god-mode-timewarp-btn"===e){const t={};Object.keys(n.tests).forEach((e=>{const o=new Date(e+"T00:00:00");o.setDate(o.getDate()+7);const a=L(o);t[a]=n.tests[e]})),n.tests=t,q()}if("god-mode-scramble-btn"===e){let t=n.layout;for(let e=t.length-1;e>0;e--){const o=Math.floor(Math.random()*(e+1));[t[e],t[o]]=[t[o],t[e]]}q()}"god-mode-nuke-btn"===e&&(i.dashboardGrid.querySelectorAll(".card").forEach(((t,e)=>{t.style.animation=`fall-apart 1s ease-in-out ${.05*e}s forwards`})),setTimeout((()=>{x("Dashboard nuked. Restore?",(()=>{i.dashboardGrid.innerHTML="",q()}),"KABOOM!")}),1500))}}));function O(){try{document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen()}catch(t){console.warn("Fullscreen request failed.",t)}document.addEventListener("visibilitychange",R),document.addEventListener("fullscreenchange",N)}function U(){try{document.fullscreenElement&&document.exitFullscreen&&document.exitFullscreen()}catch(t){console.warn("Exit fullscreen request failed.",t)}document.removeEventListener("visibilitychange",R),document.removeEventListener("fullscreenchange",N);const{cardId:t,type:e}=n.activeTimer,o=i.dashboardGrid.querySelector(`[data-card-id="${t}"]`);if(o){const t=o.querySelector(".focus-status");t&&(t.textContent="")}}function N(){if(!document.fullscreenElement&&n.activeTimer.cardId){const{cardId:t,type:e}=n.activeTimer;"pomodoro"===e&&$.stop(t),"time-logger"===e&&timeLogger.pause(t)}}function R(){const{cardId:t,type:e}=n.activeTimer;if(!t||"time-logger"!==e)return;const o=timeLogger,a=n.timeLoggerState[t];if(a)if("hidden"===document.visibilityState)a.isRunning&&o.pause(t,!1);else if("visible"===document.visibilityState&&a.isRunning){const e=(Date.now()-a.startTime)/1e3;a.accumulatedTime+=Math.round(e),o.start(t)}}i.mainTitle.addEventListener("click",(t=>{3===t.detail&&(clearTimeout(null),i.inputs.theme.querySelector('[value="alakh-pandey"]').classList.remove("hidden"),n.settings.theme="alakh-pandey",n.saveSettings(),M(),q())})),document.addEventListener("click",(()=>{const t=document.getElementById("user-menu-dropdown");t&&!t.classList.contains("hidden")&&t.classList.add("hidden")})),g(),M(),q(),new Sortable(i.dashboardGrid,{animation:150,handle:".drag-handle",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",onEnd:()=>{n.layout=[...i.dashboardGrid.children].map((t=>t.dataset.cardId)),n.save("layout")}}),setInterval((()=>{const t=i.dashboardGrid.querySelector('[data-card-id="countdown"]');t&&B.countdown.render(t);const e=i.dashboardGrid.querySelector('[data-card-id="time"]');e&&B.time.render(e)}),1e3),window.addEventListener("beforeunload",(()=>{n.activeTimer.cardId&&"time-logger"===n.activeTimer.type&&(console.log("Unload event: Forcing final save for active study logger."),timeLogger.pause(n.activeTimer.cardId,!1))}));const z=document.getElementById("info-modal"),J=z.querySelectorAll(".tab-btn"),G=z.querySelectorAll(".tab-content");z.addEventListener("click",(t=>{const e=t.target.closest(".tab-btn");if(!e)return;const o=e.dataset.tab;J.forEach((t=>{t.classList.toggle("active",t.dataset.tab===o)})),G.forEach((t=>{t.classList.toggle("hidden",t.id!==`tab-${o}`)}))}))}));
    </script>
</body>
</html>
